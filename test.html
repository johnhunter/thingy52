<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Test</title>
</head>

<body>
  <main>
    <h1>Thingy52 web controller</h1>

    <h2>LED controls</h2>

    <button id="reset-btn">Reset</button>
    <button id="on-btn">Red light on</button>
    <button id="off-btn">Red light off</button>
    <button id="cycle-btn">Cycle light colours</button>

  </main>


  <script src="//www.puck-js.com/puck.js"></script>
  <script>
    const write = cmd => {
      console.info('send: %o', cmd);
      if (location.protocol === 'https:') {
        Puck.write(`${cmd}\n`);
      }
    }

    const cycleCommands = [
      'digitalWrite([LED3,LED2,LED1],0);',
      'digitalWrite([LED3,LED2,LED1],1);',
      'digitalWrite([LED3,LED2,LED1],2);',
      'digitalWrite([LED3,LED2,LED1],4);',
    ];

    let currCycle = 0;

    const clickHandler = ({ target }) => {
      switch(target.id) {
        case 'reset-btn':
          write('reset();');
          break;
        case 'on-btn':
          write('LED1.set();');
          break;
        case 'off-btn':
          write('LED1.reset();');
          break;
        case 'cycle-btn':
          currCycle = (currCycle + 1) % cycleCommands.length;
          write(cycleCommands[currCycle]);
        break;
      }
    };

    document.addEventListener('click', clickHandler);

  </script>
</body>
</html>
